<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Jetter Server</title>
    <style>
        .description {
            display: flex;
            align-items: center;
            justify-content: left;
            width: 100%;
            height: 20px;
            margin-bottom: 20px;
        }

        .service {
            display: flex;
            align-items: center;
            justify-content: left;
            width: 100%;
            height: 20px;
            padding: 10px;
        }

        .circle {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-left: 10px;
        }

        .green {
            background-color: green;
        }

        .red {
            background-color: red;
        }
    </style>
</head>
<body style="font-family: Arial;">
<h1 style="font-size: 32px;">Jetter Server</h1>
<div class="description">
    List of Services
    <div class="circle red"></div> = Offline
    <div class="circle green"></div> = Online
</div>
<div id="streetbeatzlb" class="service">
    <!-- link to the service -->
    <a href="https://hjetter.ddns.net/streetbeatzlb" target="_self">StreetbeatzLB Webpage</a>
    <div class="circle red"></div>
</div>
<div id="spuga" class="service">
    <!-- link to the service -->
    <a href="https://hjetter.ddns.net/spuga" target="_self">Spuga Webpage</a>
    <div class="circle red"></div>
</div>
<div id="osrm" class="service">
    <!-- link to the service -->
    <a href="https://hjetter.ddns.net/osrm" target="_self">OSRM API</a>
    <div class="circle red"></div>
</div>

<script>
    function switchStatusOnline(id) {
        const circle = document.getElementById(id).children.item(1);
        circle.classList.remove('red');
        circle.classList.add('green');

        const link = document.getElementById(id).children.item(0);
        link.href = 'https://hjetter.ddns.net/' + id;
    }

    function switchStatusOffline(id) {
        const circle = document.getElementById(id).children.item(1);
        circle.classList.remove('green');
        circle.classList.add('red');

        const link = document.getElementById(id).children.item(0);
        link.href = 'https://hjetter.ddns.net/maintenance';
    }

    function checkService(id) {
        const url = new URL('https://hjetter.ddns.net/' + id);

        <!-- check on page load if the service is online -->
        fetch(url)
            .then(response => {
                if (response.ok || response.status === 400)
                    switchStatusOnline(id);
                else
                    switchStatusOffline(id);
            })
            .catch(error => {
                console.log("Fehler beim Abrufen der URL:", error);
                switchStatusOffline(id);
            });
    }

    // call the function for each service on page load
    checkService("streetbeatzlb");
    checkService("spuga");
    checkService("osrm");

    // call the function for each service in 10 second intervals
    setInterval(async () => {
        checkService("streetbeatzlb");
        checkService("spuga");
        checkService("osrm");
    }, 10000)
</script>
</body>
</html>